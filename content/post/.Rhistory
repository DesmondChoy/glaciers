labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot() +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
nudge_x = -3,
nudge_y = -0.2,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot() +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot() +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "bottom", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot() +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_colour_fish_d(option = "Antennarius_commerson") +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot(alpha = 0.5) +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_colour_fish_d(option = "Antennarius_commerson") +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot(alpha = 0.7) +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_colour_fish_d(option = "Antennarius_commerson") +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot() +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_colour_fish_d(option = "Antennarius_commerson") +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot() +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_colour_fish_d(option = "Chromis_vanderbilti") +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot() +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_colour_fish_d(option = "Oncorhynchus_keta") +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot() +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_colour_fish_d(option = "Antennarius_commerson") +
scale_fill_fish_d(option = "Antennarius_commerson") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
mutate(contracted = case_when(is.na(team_position) ~ "No",
TRUE ~ "Yes")) %>%
pivot_longer(pace:physic, names_to = "skills", values_to = "values") %>%
filter(!position == "GK") %>%
mutate(skills = reorder_within(skills, values, position)) %>%
ggplot(aes(values, skills, fill = contracted)) +
geom_boxplot() +
geom_text(
data = . %>%
group_by(position, skills) %>%
mutate(percentile = values > quantile(values, 0.99999, na.rm = TRUE)) %>%
filter(percentile == 1),
aes(label = paste(short_name, "\n", str_wrap(club, width = 15), sep = ""), colour = position),
size = 3,
check_overlap = TRUE,
fontface = "bold",
vjust = "inward", hjust = "inward",
show.legend = F
) +
facet_wrap( ~ position, scales = "free_y", labeller = as_labeller(labels)) +
scale_y_reordered() +
scale_colour_fish_d(option = "Antennarius_commerson") +
scale_fill_fish_d(option = "Hypsypops_rubicundus") +
labs(
x = "Values",
y = "Skills",
fill = "Under Contract?",
title = "Players With And Without Contracts In FIFA 20 - How Do They Compare?",
subtitle = "Using traits like dribbling, passing and shooting, players with only international appearances and\nno club contracts don't appear to be less skilled.\nHowever there are significantly more outliers among players with contracts.\nThe extreme outliers and their clubs are highlighted.",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
legend.title = element_text(face = "bold", size = 15),
legend.position = "top"
)
data %>%
select(short_name, club, position, player_tags, player_traits) %>%
na.omit() %>%
sample_n(10)
library(widyr)
library(igraph)
library(ggraph)
corr <- data %>%
select(short_name, club, position, player_tags, player_traits) %>%
separate(player_tags, paste("tag", 1:10, sep = ""), sep = ", ") %>%
separate(player_traits, paste("trait", 1:8, sep = ""), sep = ", ") %>%
pivot_longer(tag1:trait8, names_to = "tag", values_to = "description", values_drop_na = T) %>%
mutate(description = str_replace(description, "#", "")) %>%
filter(!str_detect(description, "CPU AI Only")) %>%
group_by(description) %>%
filter(n() > 100) %>%
pairwise_cor(description, short_name, sort = TRUE)
corr
library(widyr)
library(igraph)
library(ggraph)
corr <- data %>%
select(short_name, club, position, player_tags, player_traits) %>%
separate(player_tags, paste("tag", 1:10, sep = ""), sep = ", ") %>%
separate(player_traits, paste("trait", 1:8, sep = ""), sep = ", ") %>%
pivot_longer(tag1:trait8, names_to = "tag", values_to = "description", values_drop_na = T) %>%
mutate(description = str_replace(description, "#", "")) %>%
filter(!str_detect(description, "CPU AI Only")) %>%
group_by(description) %>%
filter(n() > 100) %>%
pairwise_cor(description, short_name, sort = TRUE)
corr
set.seed(2020)
corr %>%
filter(correlation > .03) %>%
graph_from_data_frame() %>%
ggraph(layout = "fr") +
geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
geom_node_point(color = "lightblue", size = 5) +
geom_node_text(
aes(label = name),
repel = TRUE,
fontface = "bold",
vjust = -1,
hjust = -0.2
) +
labs(
title = "Visualizing Correlation Of Players' Tags and Traits With A Network Graph",
subtitle = "Crowd favourites tend to be selfish acrobats that excel at beating offside traps and arguing with officials\nDoes any particular player come to mind?",
caption = "Source: FIFA 20 Complete Player Data Set"
) +
theme(
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 17),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = 15),
)
